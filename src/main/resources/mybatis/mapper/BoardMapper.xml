<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.eggmoney.payv.infrastructure.mybatis.mapper.BoardMapper">

  <!-- 컬럼 목록 -->
  <sql id="Board_Columns">
    board_id, user_id, type, title, content, visibility, view_count, created_at, updated_at
  </sql>

  <!-- resultMap: snake_case ↔ camelCase -->
  <resultMap id="BoardRecordMap" type="com.eggmoney.payv.infrastructure.mybatis.record.BoardRecord">
    <id     property="boardId"   column="board_id"/>
    <result property="userId"    column="user_id"/>
    <result property="type"      column="type"/>
    <result property="title"     column="title"/>
    <result property="content"   column="content"/>
    <result property="visibility" column="visibility"/>
    <result property="viewCount" column="view_count"/>
    <result property="createdAt"  column="created_at"/>
    <result property="updatedAt"  column="updated_at"/>
  </resultMap>

  <!-- 단건 조회 -->
  <select id="selectById" parameterType="string" resultMap="BoardRecordMap">
    SELECT <include refid="Board_Columns"/>
    FROM board
    WHERE board_id = #{boardId}
  </select>

  <!-- 사용자별 목록 -->
  <select id="selectListByUser" parameterType="string" resultMap="BoardRecordMap">
    SELECT <include refid="Board_Columns"/>
    FROM board
    WHERE user_id = #{userId}
    ORDER BY created_at DESC
  </select>

  <!-- 전체 목록 -->
  <select id="selectAll" resultMap="BoardRecordMap">
    SELECT <include refid="Board_Columns"/>
    FROM board
    ORDER BY created_at DESC
  </select>

  <!-- INSERT -->
  <insert id="insert" parameterType="com.eggmoney.payv.infrastructure.mybatis.record.BoardRecord">
    INSERT INTO board
      (board_id, user_id, type, title, content, visibility, view_count, created_at, updated_at)
    VALUES
      (#{boardId}, #{userId}, #{type}, #{title}, #{content}, #{visibility}, #{viewCount},
       #{createdAt}, #{updatedAt})
  </insert>

  <!-- UPDATE (PK 기준) -->
  <update id="update" parameterType="com.eggmoney.payv.infrastructure.mybatis.record.BoardRecord">
    UPDATE board
    SET
      type      = #{type},
      title     = #{title},
      content   = #{content},
      visibility= #{visibility},
      view_count= #{viewCount},
      updated_at= #{updatedAt}
    WHERE board_id = #{boardId}
  </update>

  <!-- 삭제 -->
  <delete id="deleteById" parameterType="string">
    DELETE FROM board WHERE board_id = #{boardId}
  </delete>

</mapper>
